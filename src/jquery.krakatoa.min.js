(function(c){var b=0;c.fn.krakatoa=function(e){var e=c.extend({},c.fn.krakatoa.defaults,e);return this.each(function(){var q,o,h=c(this),j=h.children().length,f,m,s,n,g,r,k,p=0,l;
l=(c(this).data("settings"))?c.extend({},e,d(c(this).data("settings"))):e;if(h.data("krakatoa")){return;}h.html('<div class="krakatoa-control"></div><div class="krakatoa-container">'+h.html()+"</div>");
f=h.find(".krakatoa-container");h.css({position:"relative",width:l.width,display:l.display});f.css({overflow:"hidden",position:"relative",height:l.height});
f.children().css({position:"absolute",top:0,left:0,width:l.width,height:l.height,display:"none"});f.find("img").css({width:"100%",});h.find(".krakatoa-control").append('<ul class="arrows"><li data-move="-1" class="arrow arrow-left"><a href="#">&laquo;</a></li><li data-move="1" class="arrow arrow-right"><a href="#">&raquo;</a></li></ul>');
h.find(".arrows").on("click touchstart","li",{settings:l},a);if(!l.arrows){h.find(".arrows").css("display","none");}if(l.buttons){o='<ul class="buttons">';
for(n=0;n<j/l.items;n++){o+='<li class="pagination"><a href="#">'+n+"</a></li>";}o+="</ul>";h.find(".krakatoa-control").append(o);h.find(".buttons").on("click touchstart","li",{settings:l},a).find("li").eq(l.first).addClass("active-button");
}g=h.width();k=(g-(l.items-1)*l.gutter)/l.items;for(n=0;n<l.items&&l.first+n<j;n++){s=f.children().eq(l.first+n);s.addClass("current").css({display:"block",width:k,left:(k+l.gutter)*n});
r=l.height==="auto"?s.height():l.height;if(r>p){p=r;}}f.css("height",r);h.attr("data-current",l.first);h.attr("data-krakatoa",true);if(l.autoplay){l.playing=true;
c.fn.krakatoa.play(l,h);h.on("mouseleave",function(){c.fn.krakatoa.play(l,h);});h.on("mouseover",function(){clearTimeout(b);l.playing=false;});}else{l.playing=false;
}});};c.fn.krakatoa.play=function(e,f){b=window.setTimeout(function(){f.find(".arrow-"+e.direction).trigger("click");},e.delay);if(e.autoplay){e.playing=true;
}};c.fn.krakatoa.defaults={width:"400px",height:"300px",display:"block",arrows:true,buttons:true,items:1,first:0,gutter:10,loop:false,autoplay:false,direction:"right",delay:2000,duration:500};
function a(t){var l=c(this),r=l.closest(".krakatoa-control").parent(),j=r.find(".krakatoa-container"),o=parseInt(r.attr("data-current")),g=j.children().length,j,f,s,p,n,q,m,v,k,h=0,x=c.Deferred(),u=t.data.settings,w=0;
t.preventDefault();if(l.attr("data-move")){p=l.data("move");n=o+u.items*p;if(u.loop&&(n<0||n>=g)){n=Math.ceil(g/u.items)*u.items-n*p;}else{if(n<0||n>=g){if(u.playing){u.playing=false;
}return;}}}else{if(u.buttons){if(l.hasClass("active-button")){return;}p=(l.index()*u.items>o)?1:-1;n=l.index()*u.items;}}l.parent().off("click touchstart","li").on("click touchstart","li",function(i){i.preventDefault();
});q=r.width();k=(q-(u.items-1)*u.gutter)/u.items;for(s=0;s<u.items;s++){v=j.children().eq(o+s);v.removeClass("current").animate({left:-(q+u.gutter)*p+(k+u.gutter)*s},u.duration,"linear",function(){c(this).css({left:0,display:"none"});
});if(n+s>g-1){continue;}w++;v=j.children().eq(n+s);v.addClass("current").css({display:"block",width:k,left:(q+u.gutter)*p+(k+u.gutter)*s}).animate({left:(k+u.gutter)*s},u.duration,"linear",function(){w--;
if(w===0){x.resolve();}});m=u.height==="auto"?v.height():u.height;if(m>h){h=m;}}j.css("height",m);r.attr("data-current",n);x.done(function(){if(u.playing){c.fn.krakatoa.play(u,r);
}l.parent().off("click touchstart","li");l.parent().on("click touchstart","li",{settings:u},a);});o=Math.round(n/u.items);if(u.buttons){r.find(".active-button").removeClass("active-button").parent().children().eq(o).addClass("active-button");
}}function d(f){var h=new Object(),j=[],e=0,g;if(typeof f!=="string"){return;}f=f.replace(/[{}\s]/g,"");j=f.split(",");for(e;e<j.length;e++){g=j[e].split(":");
if(!isNaN(g[1]-0)){if(g[1]%1===0){g[1]=parseInt(g[1]);}else{g[1]=parseFloat(g[1]);}}else{if(g[1].toLowerCase()=="true"||g[1].toLowerCase()=="false"){g[1]=(g[1]=="true");
}}h[g[0]]=g[1];}return h;}}(jQuery));