(function(c){var b=0;c.fn.krakatoa=function(e){var e=c.extend({},c.fn.krakatoa.defaults,e);return this.each(function(){var r,p,h=c(this),k=h.children().length,f,o,n,m,g,s,j,q=0,l;
l=(c(this).data("settings"))?c.extend({},e,d(c(this).data("settings"))):e;if(h.data("krakatoa")){return;}h.html('<div class="krakatoa-control"></div><div class="krakatoa-container">'+h.html()+"</div>");
f=h.find(".krakatoa-container");h.css({position:"relative",width:l.width,display:l.display});f.css({overflow:"hidden",position:"relative",height:l.height});
f.children().css({position:"absolute",top:0,left:0,width:l.width,height:l.height,display:"none"});f.find("img").css({width:"100%",});h.find(".krakatoa-control").append('<ul class="arrows clearfix"><li data-move="-1" class="arrow arrow-left"><a href="#">&laquo;</a></li><li data-move="1" class="arrow arrow-right"><a href="#">&raquo;</a></li></ul>');
h.find(".arrows").on("click touchstart","li",{settings:l},a);if(!l.arrows){h.find(".arrows").css("display","none");}if(l.buttons){p='<ul class="buttons">';
for(m=0;m<k/l.items;m++){p+='<li class="pagination"><a href="#">'+m+"</a></li>";}p+="</ul>";h.find(".krakatoa-control").append(p);h.find(".buttons").on("click touchstart","li",{settings:l},a).find("li").eq(l.first).addClass("active-button");
}g=f.outerWidth(true);j=(g-(l.items-1)*l.gutter)/l.items;for(m=0;m<l.items&&l.first+m<k;m++){n=f.children().eq(l.first+m);n.addClass("current").css({display:"block",width:j,left:(j+l.gutter)*m});
s=l.height==="auto"?n.outerHeight(true):l.height;if(s>q){q=s;}}f.css("height",s);h.attr("data-current",l.first);h.attr("data-krakatoa",true);if(l.autoplay){l.playing=true;
c.fn.krakatoa.play(l,h);h.on("mouseleave",function(){c.fn.krakatoa.play(l,h);});h.on("mouseover",function(){clearTimeout(b);l.playing=false;});}else{l.playing=false;
}});};c.fn.krakatoa.play=function(e,f){b=window.setTimeout(function(){f.find(".arrow-"+e.direction).trigger("click");},e.delay);if(e.autoplay){e.playing=true;
}};c.fn.krakatoa.defaults={width:"400px",height:"300px",display:"block",arrows:true,buttons:true,items:1,first:0,gutter:10,loop:false,autoplay:false,direction:"right",delay:2000,duration:500};
function a(u){var l=c(this),r=l.closest(".krakatoa-control").parent(),k=r.find(".krakatoa-container"),o=parseInt(r.attr("data-current")),s=k.children().eq(o),h=k.children().length,k,f,t,p,n,q,m,g,j=0,x=c.Deferred(),v=u.data.settings,w=0;
u.preventDefault();if(l.attr("data-move")){p=l.data("move");n=o+v.items*p;if(v.loop&&(n<0||n>=h)){n=Math.ceil(h/v.items)*v.items-n*p;}else{if(n<0||n>=h){if(v.playing){v.playing=false;
}return;}}}else{if(v.buttons){if(l.hasClass("active-button")){return;}p=(l.index()*v.items>o)?1:-1;n=l.index()*v.items;}}l.parent().off("click touchstart","li").on("click touchstart","li",function(i){i.preventDefault();
});q=k.outerWidth(true);g=(q-(v.items-1)*v.gutter)/v.items;for(t=0;t<v.items;t++){f=k.children().eq(o+t);f.removeClass("current").animate({left:-(q+v.gutter)*p+(g+v.gutter)*t},v.duration,"linear",function(){c(this).css({left:0,display:"none"});
});if(n+t>h-1){continue;}w++;f=k.children().eq(n+t);f.addClass("current").css({display:"block",width:g,left:(q+v.gutter)*p+(g+v.gutter)*t}).animate({left:(g+v.gutter)*t},v.duration,"linear",function(){w--;
if(w===0){x.resolve();}});m=v.height==="auto"?f.outerHeight(true):v.height;if(m>j){j=m;}}k.css("height",m);r.attr("data-current",n);x.done(function(){if(v.playing){c.fn.krakatoa.play(v,r);
}l.parent().off("click touchstart","li");l.parent().on("click touchstart","li",{settings:v},a);});o=Math.round(n/v.items);if(v.buttons){r.find(".active-button").removeClass("active-button").parent().children().eq(o).addClass("active-button");
}}function d(f){var h=new Object(),j=[],e=0,g;if(typeof f!=="string"){return;}f=f.replace(/[{}\s]/g,"");j=f.split(",");for(e;e<j.length;e++){g=j[e].split(":");
if(!isNaN(g[1]-0)){if(g[1]%1===0){g[1]=parseInt(g[1]);}else{g[1]=parseFloat(g[1]);}}else{if(g[1].toLowerCase()=="true"||g[1].toLowerCase()=="false"){g[1]=(g[1]=="true");
}}h[g[0]]=g[1];}return h;}}(jQuery));